---
import Icon from './icons/index.astro';
import { NAV_LINKS } from '../lib';
---

<button
	id="open-sidebar"
	aria-label="Open menu"
	class="md:hidden text-muted hover:text-foreground transition-colors p-2"
>
	<Icon name="menu" size={20} />
</button>

<aside
	id="sidebar"
	class="fixed top-0 left-0 w-full h-screen bg-background z-50 md:hidden transform translate-x-full transition-transform duration-200"
>
	<div class="px-6 h-full">
		<div class="flex justify-end h-[72px] items-center">
			<button
				id="close-sidebar"
				class="text-muted hover:text-foreground transition-colors p-2"
				aria-label="Close menu"
			>
				<Icon name="x" size={20} />
			</button>
		</div>
		<nav aria-label="Mobile navigation">
			<ul class="space-y-1">
				{NAV_LINKS.map(link => (
					<li>
						<a
							href={link.href}
							class="block py-3 text-muted hover:text-foreground transition-colors"
						>
							{link.name}
						</a>
					</li>
				))}
			</ul>
		</nav>
	</div>
</aside>

<script>
	const openBtn = document.getElementById('open-sidebar');
	const closeBtn = document.getElementById('close-sidebar');
	const sidebar = document.getElementById('sidebar');
	const links = sidebar?.querySelectorAll('a');

	function openSidebar() {
		sidebar?.classList.remove('translate-x-full');
		sidebar?.classList.add('translate-x-0');
		document.body.style.overflow = 'hidden';
	}

	function closeSidebar() {
		sidebar?.classList.remove('translate-x-0');
		sidebar?.classList.add('translate-x-full');
		document.body.style.overflow = '';
	}

	openBtn?.addEventListener('click', openSidebar);
	closeBtn?.addEventListener('click', closeSidebar);
	links?.forEach(link => link.addEventListener('click', closeSidebar));

	document.addEventListener('keydown', (e) => {
		if (e.key === 'Escape') closeSidebar();
	});
</script>
